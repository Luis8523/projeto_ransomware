from cryptography.fernet import Fernet
import os

# ğŸ“¥ Carrega a chave usada na criptografia
with open("key.key", "rb") as key_file:
    key = key_file.read()

fernet = Fernet(key)

# ğŸ“‚ Caminho dos arquivos criptografados
folder_path = "arquivos"

# ğŸ” Percorre e descriptografa os arquivos
for filename in os.listdir(folder_path):
    filepath = os.path.join(folder_path, filename)

    # Ignora pastas
    if os.path.isdir(filepath):
        continue

    # LÃª conteÃºdo cifrado
    with open(filepath, "rb") as file:
        encrypted = file.read()

    # ğŸ”“ Tenta decifrar
    try:
        decrypted = fernet.decrypt(encrypted)
    except Exception as e:
        print(f"âŒ Erro ao decifrar '{filename}': {e}")
        continue

    # Sobrescreve com conteÃºdo original
    with open(filepath, "wb") as file:
        file.write(decrypted)

    # Mensagem de sucesso
    print(f"âœ… Arquivo '{filename}' decifrado com sucesso!")
